[Variables]
rank = 1
desc = Assigning variables
commands = 	[
        "${DEVICE}=Echo /dev/ttyUSB0",
        "${NORUTIL}=Echo /tmp/norutil.rom_img",
        "${MFG}=Echo /tmp/mfg_nor_slot.bin",
        "${WORD0}=Echo 01020103",
        "${WORD1}=Echo 03000000",
        "${VCA}=Echo /tmp/aspen_m2_1920gB_a0.vpkg"
        ]

[Download firmware]
rank = 2
desc = Downloads lates firmware from server
commands = [
        "Http download http://imsarchive.int.fusionio.com/snowbird/product/development/LATEST/Nvme_Linux_DebugR30_aspen_m2_1920gB_a0/build/nvme/aspen_m2_1920gB_a0/Debug/aspen_m2_1920gB_a0.vpkg /tmp/aspen_m2_1920gB_a0.vpkg",
        "Http download http://imsarchive.int.fusionio.com/snowbird/product/development/LATEST/Nvme_Linux_DebugR30_aspen_m2_1920gB_a0/build/nvme/aspen_m2_1920gB_a0/Debug/bin/norutil.rom_img /tmp/norutil.rom_img",
        "Http download http://imsarchive.int.fusionio.com/snowbird/product/development/LATEST/Nvme_Linux_DebugR30_aspen_m2_1920gB_a0/build/nvme/aspen_m2_1920gB_a0/Debug/bin/mfg_nor_slot.bin /tmp/mfg_nor_slot.bin"
        ]

[Flash image]
rank = 3
desc = Downloads image to drive.
commands = [
        "Serial command ${DEVICE} 'reset now' >",
        "Serial sendfile ${DEVICE} 'image upload' /tmp/norutil.rom_img >",
        "Serial command ${DEVICE} 'image mem' >",
        "Serial command ${DEVICE} 'image run mem' >",
        "Serial command ${DEVICE} 'erase all' >",
        "Serial sendfile ${DEVICE} 'upload' /tmp/mfg_nor_slot >",
        "Serial command ${DEVICE} 'not set IMG0' >",
        "Serial command ${DEVICE} 'nor erase' >",
        "Serial command ${DEVICE} 'nor prog' >",
        "Serial command ${DEVICE} 'nor cmp' >",
        "Serial command ${DEVICE} 'reset now' >",
        "Serial command ${DEVICE} 'image run 0' >",
        "Serial command ${DEVICE} 'mfginfo set spidh_word0 ${WORD0}' >",
        "Serial command ${DEVICE} 'fginfo set spidh_word1 ${WORD1}' >",
        "Serial command ${DEVICE} 'mfginfo set serial_num SN12345' >",
        "Serial command ${DEVICE} 'mfginfo save' >",
        "Serial command ${DEVICE} 'reset now' >",
        "Serial command ${DEVICE} 'image run 0' >",
        "Serial sendfile ${DEVICE} 'image upload' ${VCA} >",
        "Serial command ${DEVICE} 'vca slot 0' >",
        "Serial command ${DEVICE} 'reset now' >",
        "Serial command ${DEVICE} 'image run 0' >"
    ]

